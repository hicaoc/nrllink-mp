<view class="container">
  <!-- User Section -->
  <view class="header-section">
    <view class="user-card">
      <button class="avatar-wrapper" open-type="chooseAvatar" bind:chooseavatar="onChooseAvatar">
        <image class="avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
      </button>
      <view class="info">
        <view class="info-top">
          <text class="name">{{userInfo.name || 'USER'}}</text>
          <view class="call-sign-tag">{{userInfo.callsign}}-100 </view>
          <view class="call-sign-tag">  {{userInfo.dmrid}}  </view>
          <view class="call-sign-tag"> {{userInfo.mdcid}}</view>
        </view>
        <text class="current-group">{{currentGroup || 'STANDBY'}}</text>
      </view>
    </view>
  </view>

  <!-- Monitor Section: Digital LCD Style -->
  <view class="monitor-section">
    <view class="active-call-display" wx:if="{{CallSign}}">
      <text class="caller-info">{{CallSign}}-{{SSID}}-{{DMRID}}</text>
      <view class="call-metrics">
        <text>{{lastVoiceDisplayTime}}</text>
        <text style="color: #07C160">{{duration}}s</text>
      </view>
    </view>
    <view class="no-call" wx:else>
      STANDBY
    </view>
  </view>

  <!-- History Section -->
  <view class="history-section">
    <text class="section-label">Log History</text>
    <scroll-view class="call-history" scroll-y enable-flex>
      <view class="history-item" wx:for="{{callHistory}}" wx:key="endTime">
        <view class="h-avatar">{{item.CallSign[0]}}</view>
        <view class="h-info">
          <view class="h-top">
            <text class="h-sign">{{item.CallSign}}-{{item.SSID}} {{item.DMRID}}</text>
            <text class="h-time">{{item.endTime}}</text>
          </view>
          <view class="h-bottom">
            <text class="h-qth">{{item.QTH}}</text>
            <text class="h-dur">{{item.duration}}s</text>
          </view>
        </view>
      </view>
    </scroll-view>
  </view>

  <!-- Control Section -->
  <view class="controls-section">
    <view class="talk-btn-wrapper">
      <view class="outer-ring {{isTalking ? 'transmitting' : ''}}"></view>
      <button 
        class="talk-btn {{isTalking ? 'active' : ''}}" 
        bindtap="toggleTalk"
      >
        <text class="btn-text">{{isTalking ? 'TX' : 'PTT'}}</text>
      </button>
    </view>
  </view>

  <!-- Footer Status -->
  <view class="footer-status">
    <view class="server-info">
      <view class="status-dot {{serverConnected ? 'connected' : 'disconnected'}}"></view>
      <view class="server-label">{{server.name || 'Server'}}</view>
    </view>
    <view class="host-link" bindtap="showThanksList">{{server.host}}</view>
  </view>

  <!-- Thanks List Modal -->
  <view class="thanks-list" wx:if="{{showList}}" bindtap="showThanksList">
    <view class="thanks-header">Acknowledgments</view>
    <view class="thanks-grid">
      <view class="thanks-item" wx:for="{{thanksItems}}" wx:key="index">{{item}}</view>
    </view>
  </view>
</view>
